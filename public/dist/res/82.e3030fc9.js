(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{380:function(t,e,a){},516:function(t,e,a){"use strict";var i=a(380);a.n(i).a},584:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"stock-contianer"},[a("div",{staticClass:"stock-tray-title"},[a("dl",[a("dt",[t._v(t._s(t.dataset.garbage.name))]),t._v(" "),a("dd",[a("p",[t._v("总重量："),a("span",[t._v(t._s(t.dataset.ibase.allnumner)+"kg")])])])])]),t._v(" "),a("van-list",{attrs:{finished:t.dataset.finished,"finished-text":""},on:{load:t.controllerRequestList},model:{value:t.dataset.loading,callback:function(e){t.$set(t.dataset,"loading",e)},expression:"dataset.loading"}},t._l(t.dataset.items,(function(e,i){return a("tray-item-list",{key:i,staticClass:"stock-order-list",attrs:{ibase:[],dataset:e,index:i,allSelect:t.allSelectState},on:{onSelectOperate:t.eventOnSelectItemOperate}})})),1),t._v(" "),a("div",{staticClass:"page-bottom-bar"},[a("div",{staticClass:"flex-item check-all-select"},[a("van-checkbox",{model:{value:t.allSelectState,callback:function(e){t.allSelectState=e},expression:"allSelectState"}},[t._v("全选")])],1),t._v(" "),a("div",{staticClass:"flex-item tip-message"},[t._v("已选择 "+t._s(t.selectItems.length)+" 条数据")]),t._v(" "),a("div",{staticClass:"flex-item"},[a("span",{staticClass:"bar-button bar-button-green",on:{click:t.eventClickPopSelectItem}},[t._v("出库")])])])],1)};i._withStripped=!0;a(241);var s,r=a(242),n=(a(197),a(198)),l=a(419);function o(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var d={name:"ReservoirManageStockTrayDetails",components:(s={},o(s,n.a.name,n.a),o(s,r.a.name,r.a),o(s,"TrayItemList",l.a),s),data:function(){return{allSelectState:!1,selectItems:[],trayId:0,dataset:{page:0,limit:30,loading:!1,finished:!1,items:[],garbage:{},ibase:{}}}},methods:{controllerRequestList:function(){var t=this,e={token:this.$route.query.token,id:this.$route.query.child},a=[],i=[];this.$util.postRequestInterface("/api/home/tray/orderlist",e,(function(e){if(t.dataset.garbage=e.data.garbage,t.dataset.ibase.allnumner=e.data.allnumner,t.dataset.ibase.allweight=e.data.allweight,t.trayId=e.data.id,e.data.orderlist){var s=!0,r=!1,n=void 0;try{for(var l,o=e.data.orderlist[Symbol.iterator]();!(s=(l=o.next()).done);s=!0){var d=l.value,c=d.garbageall;a.push({goid:d.goid,title:d.garbage[0].name,number:c.weighting_num,unit:"kg",time:t.$moment(1e3*d.create_time).format("YYYY-MM-DD")}),i.push({ordernumne:d.ordernumne,detail:a}),a=[]}}catch(t){r=!0,n=t}finally{try{!s&&o.return&&o.return()}finally{if(r)throw n}}t.dataset.items=i}t.dataset.finished=!0,t.dataset.loading=!1}))},buildFormaDataset:function(){var t=[],e=!0,a=!1,i=void 0;try{for(var s,r=this.selectItems[Symbol.iterator]();!(e=(s=r.next()).done);e=!0){var n=s.value,l=this.dataset.items[n],o=!0,d=!1,c=void 0;try{for(var u,m=l.detail[Symbol.iterator]();!(o=(u=m.next()).done);o=!0){var v=u.value;t.push(v.goid)}}catch(t){d=!0,c=t}finally{try{!o&&m.return&&m.return()}finally{if(d)throw c}}}}catch(t){a=!0,i=t}finally{try{!e&&r.return&&r.return()}finally{if(a)throw i}}return t},eventClickPopSelectItem:function(){if(0!=this.selectItems.length){var t=window.sessionStorage.getItem("outOrder");if(t){var e={id:this.trayId,ids:JSON.stringify(this.buildFormaDataset().flat()),token:this.$store.state.options.user.token,orderid:t};this.$util.postRequestInterface("/api/home/tray/orderadd",e,(function(t){t.data}))}else this.$toast("请选择出库订单")}else this.$toast("请选择要出库的选项")},eventOnSelectItemOperate:function(t){if(t.select)this.selectItems.push(t.index);else for(var e in this.selectItems)if(e==t.index){this.selectItems.splice(e,1);break}}},watch:{allSelectState:function(t,e){this.selectItems=[]}}},c=(a(516),a(16)),u=Object(c.a)(d,i,[],!1,null,"540deb8e",null);u.options.__file="src/views/reservoirManagement/stock-tray-details.vue";e.default=u.exports}}]);